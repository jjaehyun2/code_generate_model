# Code Generate Model

μ΄ ν”„λ΅μ νΈλ” **μ½”λ“ μƒμ„±(Code Generation)** λ° **μ½”λ“ μ„¤λ…(Code Explanation)**,  
κ·Έλ¦¬κ³  **λ¨λΈ μµμ ν™” λ° ν‰κ°€**λ¥Ό μ„ν• λ‹¤μ–‘ν• νμ΄ν”„λΌμΈμ„ μ κ³µν•©λ‹λ‹¤.  

Hugging Face Transformers, Datasets λΌμ΄λΈλ¬λ¦¬λ¥Ό κΈ°λ°μΌλ΅ ν•λ©°,  
κ²½λ‰ν™” λ° μ„±λ¥ ν–¥μƒμ„ μ„ν•΄ LoRA, μ–‘μν™”(Quantization), ν”„λ£¨λ‹(Pruning) λ“±μ κΈ°λ²•μ„ μ§€μ›ν–μµλ‹λ‹¤.
---

## π€ μ£Όμ” κΈ°λ¥
- μ½”λ“ μƒμ„± λ° μ½”λ“ μ„¤λ…
- LoRA, PEFT κΈ°λ° νμΈνλ‹
- μ–‘μν™” λ° ν”„λ£¨λ‹μ„ ν†µν• λ¨λΈ κ²½λ‰ν™”
- HumanEval κΈ°λ° μ„±λ¥ ν‰κ°€
- BLEU, BERTScore λ“± λ‹¤μ–‘ν• ν‰κ°€ μ§€ν‘ μ κ³µ

---

## π“‚ ν”„λ΅μ νΈ κµ¬μ΅°

### 1. `train/`
- **train.py**  
  - JSON λ°μ΄ν„°μ…‹μ„ ν…μ¤νΈ ν¬λ§·μΌλ΅ λ³€ν™ ν›„, μ‚¬μ „ν•™μµλ λ¨λΈ(`AutoModelForCausalLM`)μ„ LoRA λ“±μΌλ΅ νμΈνλ‹  
  - 4bit μ–‘μν™”(`BitsAndBytesConfig`) λ“± λ‹¤μ–‘ν• κ²½λ‰ν™” μµμ… μ κ³µ  

- **save_and_train.py**  
  - λ°μ΄ν„°μ…‹μ„ ν•™μµ/κ²€μ¦/ν…μ¤νΈλ΅ λ¶„ν•   
  - `SFTTrainer`λ¥Ό ν™μ©ν• νμΈνλ‹ λ° λ¨λΈ μ €μ¥  
  - PEFT(νλΌλ―Έν„° ν¨μ¨μ  νμΈνλ‹)μ™€ Hugging Face Hub μ—°λ™ μ§€μ›  

- **final_train_test.py**  
  - νμΈνλ‹ λ° κ²½λ‰ν™”/ν”„λ£¨λ‹λ λ¨λΈμ„ λ¶λ¬μ™€ μ¶”κ°€ ν•™μµ λ° ν…μ¤νΈ μν–‰  
  - λ°μ΄ν„° μ „μ²λ¦¬, ν† ν¬λ‚μ΄μ € μ„¤μ •, CUDA ν™κ²½ μ§€μ›  

---

### 2. `upgrade/`
- **dynamic_quantization.py**  
  - μ‚¬μ „ν•™μµλ λ¨λΈμ— λ™μ  μ–‘μν™”(Dynamic Quantization) μ μ©  
  - λ©”λ¨λ¦¬ μ‚¬μ©λ‰ μ κ° λ° μ¶”λ΅  μ†λ„ ν–¥μƒ  
  - λ¨λΈ λ΅λ”© β†’ ν† ν¬λ‚μ΄μ € μ„¤μ • β†’ μµμ ν™” μ μ© λ° μ €μ¥  

- **post_training_pruning.py**  
  - ν•™μµ ν›„ ν”„λ£¨λ‹(Post-Training Pruning)μ„ ν†µν•΄ λ¨λΈ κ²½λ‰ν™”  
  - L1 κΈ°λ° Unstructured Pruning  
  - ν¬μ†λ„ κ³„μ‚° λ° ν”„λ£¨λ‹λ λ¨λΈ λ°ν™  

---

### 3. `test(failed)/` 
- **evaluation_test.py / evaluation_test2.py**  
  - HumanEval λ°μ΄ν„°μ…‹ κΈ°λ° μ½”λ“ μƒμ„± μ„±λ¥ ν‰κ°€  
  - μ–΄λ‘ν„° λ¨λΈκ³Ό λ² μ΄μ¤ λ¨λΈ κ²°ν•©, `safetensors` μ§€μ›  

- **test.py / test_for_new.py**  
  - νμΈνλ‹λ λ¨λΈ λ¶λ¬μ¤κΈ° λ° μ½”λ“ μƒμ„± ν…μ¤νΈ  
  - μ…λ ¥ ν”„λ΅¬ν”„νΈ κΈ°λ° μ½”λ“ μƒμ„± ν•¨μ μ κ³µ  

- **test_code_explain.py**  
  - μ½”λ“ μ„¤λ… μƒμ„± κΈ°λ¥ μ κ³µ  
  - BLEU, BERTScore λ“± λ‹¤μ–‘ν• μ§€ν‘λ¥Ό ν™μ©ν• μ„±λ¥ ν‰κ°€  

---

## μ¶”ν›„ μ‘μ—…
- μ½”λ“ ν‰κ°€λ” λ” λ³µν•©μ μΈ κΈ°λ¥μ„ μ¶”κ°€ν•μ—¬ λ³„λ„μ μ‘μ—… μ§„ν–‰
- humanevalμ΄ μ•„λ‹ μ •λ‹µ λ°μ΄ν„°μ…‹μ„ ν™μ©ν• λ‹¤λ°©λ©΄ μ μ‚¬λ„ ν‰κ°€ μμ •
- μ¶”κ°€μ μΈ λ…Όλ¬Έ λ¦¬μ„μΉ μμ •

